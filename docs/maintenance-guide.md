# 維護指南

本指南提供開發團隊在長期維護 AI Budget Tracker 專案時的建議流程，涵蓋版本管理、品質保證、依賴更新與文件維護等主題。

## 1. 分支與版本管理
- 採用 `main` 作為穩定分支，所有開發請建立 feature/bugfix 分支並透過 Pull Request 合併。
- 重大功能或破壞性改動建議建立 Release Branch，完成測試後再合併至 `main` 並打上版本標籤（建議遵循 SemVer）。
- 對外發布時更新 `CHANGELOG.md`（若尚未建立，建議新增），列出新增功能、修正與已知問題。

## 2. 依賴與工具更新
- 每月檢查一次 `npm outdated`，統整過期套件並規劃更新計畫。
- 更新前先閱讀套件發佈說明，注意破壞性變更；必要時先建立測試分支驗證。
- 套件更新後務必執行 `npm run build` 與 `npm run test`，確認建置與測試皆成功再提交。
- 若使用 Renovate 或 Dependabot，自動 PR 需由工程師審核、測試後再合併。

## 3. 測試與品質保證
- 維持單元測試覆蓋率：對計算、Hook、Context 等核心邏輯至少提供單元測試。
- 針對重要使用流程（記帳 CRUD、同步、升級、挑戰）補上整合或端對端測試，可使用 Playwright 或 Cypress。
- 建議在 CI（GitHub Actions 等）設定以下流程：
  1. 安裝依賴與快取 `node_modules`。
  2. 執行 `npm run lint`（可加入 ESLint）與 `npm run test`。
  3. 執行 `npm run build` 確保可成功打包。
- 對外部署前於 staging 環境進行手動驗證，重點覆核：同步狀態、AI 回覆、金流導向、匯出檔案。

## 4. 安全性與環境變數
- 所有金鑰、API URL、Webhook Secret 皆應存於部署平台的環境變數，不得提交至版本庫。
- 定期（至少每 6 個月）輪替 API Key 並檢查存取權限是否符合最小權限原則。
- 對外 API 建議加入速率限制、驗證（JWT、HMAC）與記錄追蹤，必要時實作異常告警。

## 5. 文件與知識管理
- 每次功能變更或設定調整需同步更新 `README.md` 與對應模組說明文件，確保新進成員能快速上手。
- `docs/` 內的操作指南與維護指南若有新流程或依賴變化，需在合併 PR 時一併更新。
- 建議建立內部 Wiki 或 Notion，紀錄部署、金流稽核、客服回報等資料。

## 6. 問題回報與支援流程
- 於 issue tracker 定義模板（Bug、Feature Request），收集必要資訊（版本、環境、操作步驟、螢幕截圖）。
- 設立優先級與回應時限，例如 P0（立即處理）、P1（3 日內）、P2（1 週內）。
- 每次修復需撰寫測試或手動驗證紀錄，並在 issue 中註記解決方式與版本。

## 7. 部署後監控
- 為同步 API、AI API 與金流入口建立監控，建議收集成功率、錯誤率、延遲與用量。
- 若部署在 Serverless 平台，應監測冷啟動時間與計費狀況，必要時調整配置或升級方案。
- 使用前端錯誤收集（如 Sentry）掌握使用者端錯誤，並定期檢視 log 以改善使用者體驗。

依照上述維護流程，能確保專案在長期運作下維持穩定性、可維護性與使用者信任。
